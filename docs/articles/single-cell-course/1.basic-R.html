<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lesson 1. Introduction to R • SeuratExtend</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Lesson 1. Introduction to R">
<meta property="og:description" content="SeuratExtend">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">SeuratExtend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/News.html">What's New in v1.1.0</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../../articles/Visualization.html">Enhanced Visualization</a>
    </li>
    <li>
      <a href="../../articles/GSEA.html">Geneset Enrichment Analysis (GSEA) </a>
    </li>
    <li>
      <a href="../../articles/Trajectory.html">Trajectory and Pseudotime Analysis </a>
    </li>
    <li>
      <a href="../../articles/SCENIC.html">SCENIC for Gene Regulatory Networks Analysis </a>
    </li>
    <li>
      <a href="../../articles/Utilities.html">Utility Tools and Functions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    scRNA-seq Course
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/single-cell-course/1.basic-R.html">1. Introduction to R</a>
    </li>
    <li>
      <a href="../../articles/single-cell-course/2.Seurat.html">2. Basic Single-Cell Analysis Workflow</a>
    </li>
    <li>
      <a href="../../articles/single-cell-course/3.Visualization.html">3. Advanced Visualization Techniques</a>
    </li>
    <li>
      <a href="../../articles/single-cell-course/4.GSEA.html">4. Gene Set Enrichment Analysis</a>
    </li>
    <li>
      <a href="../../articles/single-cell-course/5.Core-Enhancement.html">5. Core scRNA-seq Workflow Enhancements</a>
    </li>
    <li>
      <a href="../../articles/single-cell-course/6.Advanced.html">6. Advanced Methods (Part 1)</a>
    </li>
    <li>
      <a href="../../articles/single-cell-course/6.Advanced-2.html">7. Advanced Methods (Part 2)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../articles/FAQ.html">FAQ</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lesson 1. Introduction to R</h1>
                        <h4 data-toc-skip class="author">Yichao Hua</h4>
            
            <h4 data-toc-skip class="date">2024-11-29</h4>
      
      
      <div class="hidden name"><code>1.basic-R.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Welcome to our course on single-cell RNA sequencing (scRNA-seq)
analysis using R! This course is designed for beginners with no prior R
programming experience. We’ll guide you through the process of analyzing
scRNA-seq data using R, with a focus on the <code>Seurat</code> and
<code>SeuratExtend</code> packages as our primary analytical
framework.</p>
<div class="section level3">
<h3 id="what-is-r">What is R?<a class="anchor" aria-label="anchor" href="#what-is-r"></a>
</h3>
<p>R is an open-source programming language specifically designed for
statistical computing and graphics. It’s widely used in bioinformatics
and single-cell analysis due to its extensive collection of packages and
large user community.</p>
</div>
<div class="section level3">
<h3 id="setting-up-your-environment">Setting Up Your Environment<a class="anchor" aria-label="anchor" href="#setting-up-your-environment"></a>
</h3>
<p>To make using R easier and more productive, we recommend using
RStudio, an integrated development environment (IDE) for R.</p>
</div>
<div class="section level3">
<h3 id="installing-r-and-rstudio">Installing R and RStudio<a class="anchor" aria-label="anchor" href="#installing-r-and-rstudio"></a>
</h3>
<p>Follow these steps to set up your environment:</p>
<ol style="list-style-type: decimal">
<li>Visit <a href="https://posit.co/download/rstudio-desktop/" class="external-link uri">https://posit.co/download/rstudio-desktop/</a>
</li>
<li>Choose the version suitable for your operating system (Windows, Mac,
or Linux)</li>
<li>Follow the prompts to download and install R first, then
RStudio</li>
<li>Once installed, open RStudio to begin programming</li>
</ol>
</div>
<div class="section level3">
<h3 id="rstudio-interface">RStudio Interface<a class="anchor" aria-label="anchor" href="#rstudio-interface"></a>
</h3>
<p>Here’s a brief explanation of the RStudio interface:</p>
<div class="float">
<img src="images/rstudio_interface.png" alt="RStudio Interface"><div class="figcaption">RStudio Interface</div>
</div>
<ol style="list-style-type: decimal">
<li>
<strong>Source Editor</strong>: Write and edit your R scripts
here</li>
<li>
<strong>Console</strong>: Run R commands and see output</li>
<li>
<strong>Environment</strong>: View your current variables and
data</li>
<li>
<strong>Files/Plots/Packages/Help</strong>: Access files, view
plots, manage packages, and get help</li>
</ol>
<p>In this course, we provide two types of files for you to use:</p>
<ol style="list-style-type: decimal">
<li>
<strong>R files (.R)</strong>: These are plain text files containing
R code. They’re ideal for writing and running scripts.</li>
<li>
<strong>R Markdown files (.Rmd)</strong>: These combine R code with
formatted text, allowing you to create dynamic reports.
<ul>
<li>To use: Open in RStudio, write text and R code in chunks, then
‘Knit’ to generate a formatted output (e.g., HTML, PDF).</li>
</ul>
</li>
</ol>
<p>You can download all course files from: <a href="https://github.com/huayc09/single-cell-course" class="external-link uri">https://github.com/huayc09/single-cell-course</a></p>
<p>We recommend setting up a dedicated directory for this course where
you’ll store all your work and downloaded data. For consistency and
organization, we suggest creating a folder named
<code>single-cell-course</code> in your Documents directory, though you
can choose a different location if you prefer. Here are two ways to set
this up:</p>
<ol style="list-style-type: decimal">
<li>Using R code (recommended):</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a directory called 'single-cell-course' in your Documents folder</span></span>
<span><span class="co"># You can change this path to anywhere else on your computer if you prefer</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"~/Documents/single-cell-course"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tell R to use this new folder as your working directory</span></span>
<span><span class="co"># This means R will look for files and save outputs in this folder</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="st">"~/Documents/single-cell-course"</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>
<p>Using the manual approach with RStudio:</p>
<p>First, create the course directory:</p>
<ul>
<li>Open your system’s file explorer</li>
<li>Navigate to your Documents folder</li>
<li>Create a new folder named “single-cell-course”</li>
</ul>
<p>Then set it as your working directory in RStudio:</p>
<ul>
<li>Go to Session &gt; Set Working Directory &gt; Choose Directory</li>
<li>Navigate to and select your newly created “single-cell-course”
folder</li>
<li>Click ‘Open’</li>
</ul>
</li>
</ol>
<p>This directory will be your workspace throughout the course. Starting
from Lesson 2, we’ll download necessary data files and store them
here.</p>
</div>
</div>
<div class="section level2">
<h2 id="basic-r-programming">Basic R Programming<a class="anchor" aria-label="anchor" href="#basic-r-programming"></a>
</h2>
<p>Let’s start with some fundamental concepts in R programming:</p>
<div class="section level3">
<h3 id="basic-arithmetic">1. Basic Arithmetic<a class="anchor" aria-label="anchor" href="#basic-arithmetic"></a>
</h3>
<p>R can be used as a simple calculator. Try running these commands in
the console:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span> <span class="op">+</span> <span class="fl">3</span>  <span class="co"># Addition</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">10</span> <span class="op">-</span> <span class="fl">4</span>  <span class="co"># Subtraction</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">5</span> <span class="op">*</span> <span class="fl">2</span>  <span class="co"># Multiplication</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 10</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">20</span> <span class="op">/</span> <span class="fl">4</span>  <span class="co"># Division</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span><span class="op">^</span><span class="fl">3</span>  <span class="co"># Exponentiation</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 8</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="variable-assignment">2. Variable Assignment<a class="anchor" aria-label="anchor" href="#variable-assignment"></a>
</h3>
<p>Variables allow you to store and manipulate data:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">10</span>  <span class="co"># Assign value 10 to variable x</span></span>
<span><span class="va">x</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 10</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">5</span>   <span class="co"># Assign value 5 to variable y</span></span>
<span><span class="va">y</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span>  <span class="co"># Assign the sum of x and y to z</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>  <span class="co"># Print the value of z</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 15</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="basic-data-types">3. Basic Data Types<a class="anchor" aria-label="anchor" href="#basic-data-types"></a>
</h3>
<p>R has several basic data types. Here are the three most fundamental
ones:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Numeric (for numbers)</span></span>
<span><span class="va">num</span> <span class="op">&lt;-</span> <span class="fl">10.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "numeric"</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Character (for strings)</span></span>
<span><span class="va">char</span> <span class="op">&lt;-</span> <span class="st">"Hello"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">char</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "character"</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Logical (for boolean values TRUE or FALSE)</span></span>
<span><span class="va">log</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">log</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "logical"</span></span></code></pre>
<p>Logical (boolean) variables are often used for filtering data. For
example, you might use them to extract cells where a certain gene’s
expression is above a threshold, or to select samples under specific
conditions. We’ll explore this further in later lessons.</p>
</div>
<div class="section level3">
<h3 id="vectors">4. Vectors<a class="anchor" aria-label="anchor" href="#vectors"></a>
</h3>
<p>In R, vectors are one of the most fundamental data structures. We’ve
already created vectors with single elements, but vectors can contain
multiple elements of the same type.</p>
<p>To create a vector with multiple elements, we use the
<code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> function (c stands for combine):</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Numeric vector</span></span>
<span><span class="va">numbers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">numbers</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1 2 3 4 5</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Character vector</span></span>
<span><span class="va">fruits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"cherry"</span><span class="op">)</span></span>
<span><span class="va">fruits</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "apple"  "banana" "cherry"</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Boolean vector</span></span>
<span><span class="va">bool_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">bool_vec</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  TRUE FALSE  TRUE  TRUE</span></span></code></pre>
<p>R provides a simple way to create a sequence of numbers:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creates a vector of numbers from 1 to 10</span></span>
<span><span class="va">seq_numbers</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">seq_numbers</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1]  1  2  3  4  5  6  7  8  9 10</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="logical-operators">5. Logical Operators<a class="anchor" aria-label="anchor" href="#logical-operators"></a>
</h3>
<p>Let’s start by learning how to compare numbers:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span></span>
<span><span class="co"># Comparison operators</span></span>
<span><span class="va">a</span> <span class="op">&lt;</span> <span class="va">b</span>   <span class="co"># Less than</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;=</span> <span class="va">b</span>  <span class="co"># Less than or equal to</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&gt;</span> <span class="va">b</span>   <span class="co"># Greater than</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&gt;=</span> <span class="va">b</span>  <span class="co"># Greater than or equal to</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">==</span> <span class="va">b</span>  <span class="co"># Equal to</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">!=</span> <span class="va">b</span>  <span class="co"># Not equal to</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>We can also combine multiple conditions using logical operators:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Logical operations</span></span>
<span><span class="op">(</span><span class="va">a</span> <span class="op">&gt;</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">b</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span>  <span class="co"># TRUE if at least one condition is true</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">a</span> <span class="op">&gt;</span> <span class="fl">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">b</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span>  <span class="co"># TRUE if both conditions are true</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Here, we introduce the logical operators AND (<code>&amp;</code>) and
OR (<code>|</code>). These operate on boolean values. Another important
logical operator is NOT (<code>!</code>). These concepts are crucial and
we’ll explore their applications further in later lessons.</p>
</div>
<div class="section level3">
<h3 id="retrieving-elements-from-vectors">6. Retrieving Elements from Vectors<a class="anchor" aria-label="anchor" href="#retrieving-elements-from-vectors"></a>
</h3>
<p>Retrieving elements is a fundamental operation in data manipulation.
There are three main methods: using index, using logical vectors for
indexing, and using names. Let’s explore each:</p>
<div class="section level4">
<h4 id="using-index">Using Index<a class="anchor" aria-label="anchor" href="#using-index"></a>
</h4>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numbers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">100</span><span class="op">)</span>   <span class="co"># Create a numeric vector</span></span>
<span><span class="va">numbers</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>  <span class="co"># Get the third element</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 30</span></span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numbers</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span>  <span class="co"># Get the first, third, and fifth elements</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  10  30 100</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numbers</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>  <span class="co"># Get elements from index 2 to 4</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 20 30 40</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="using-logical-vector-for-indexing">Using Logical Vector for Indexing<a class="anchor" aria-label="anchor" href="#using-logical-vector-for-indexing"></a>
</h4>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numbers</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  10  30 100</span></span></code></pre>
<p>This selects the 1st, 3rd, and 5th elements where TRUE appears. This
method is powerful when combined with logical expressions. For example,
to get elements greater than 30:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numbers</span><span class="op">[</span><span class="va">numbers</span> <span class="op">&gt;</span> <span class="fl">30</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  40 100</span></span></code></pre>
<p>Let’s break down this expression:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, we create a logical vector</span></span>
<span><span class="va">numbers</span> <span class="op">&gt;</span> <span class="fl">30</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE FALSE FALSE  TRUE  TRUE</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Then we use this logical vector to select elements</span></span>
<span><span class="va">numbers</span><span class="op">[</span><span class="va">numbers</span> <span class="op">&gt;</span> <span class="fl">30</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  40 100</span></span></code></pre>
<p>In practice, we often need to combine multiple conditions. This is
where <code>&amp;</code>, <code>|</code>, and <code>!</code> come in
handy. For example, to select elements between 25 and 50:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numbers</span><span class="op">[</span><span class="va">numbers</span> <span class="op">&gt;</span> <span class="fl">25</span> <span class="op">&amp;</span> <span class="va">numbers</span> <span class="op">&lt;</span> <span class="fl">50</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 30 40</span></span></code></pre>
<p>For beginners, let’s break this down step-by-step:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Which elements are greater than 25?</span></span>
<span><span class="va">high_expr</span> <span class="op">&lt;-</span> <span class="va">numbers</span> <span class="op">&gt;</span> <span class="fl">25</span></span>
<span><span class="va">high_expr</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE FALSE  TRUE  TRUE  TRUE</span></span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Which elements are less than 50?</span></span>
<span><span class="va">low_expr</span> <span class="op">&lt;-</span> <span class="va">numbers</span> <span class="op">&lt;</span> <span class="fl">50</span></span>
<span><span class="va">low_expr</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  TRUE  TRUE  TRUE  TRUE FALSE</span></span></code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine conditions with AND (&amp;)</span></span>
<span><span class="va">high_and_low_expr</span> <span class="op">&lt;-</span> <span class="va">high_expr</span> <span class="op">&amp;</span> <span class="va">low_expr</span></span>
<span><span class="va">high_and_low_expr</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE FALSE  TRUE  TRUE FALSE</span></span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use this logical vector to select elements</span></span>
<span><span class="va">numbers</span><span class="op">[</span><span class="va">high_and_low_expr</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 30 40</span></span></code></pre>
<p>You can experiment with <code>|</code> and <code>!</code> in a
similar manner.</p>
</div>
<div class="section level4">
<h4 id="vector-operations-with-names">Vector Operations with Names<a class="anchor" aria-label="anchor" href="#vector-operations-with-names"></a>
</h4>
<p>We can also create named vectors and use names to retrieve
elements:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creating a named vector</span></span>
<span><span class="va">gene_expr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>gene1 <span class="op">=</span> <span class="fl">100</span>, gene2 <span class="op">=</span> <span class="fl">200</span>, gene3 <span class="op">=</span> <span class="fl">150</span>, gene4 <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gene_expr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## gene1 gene2 gene3 gene4 </span></span>
<span><span class="co">##   100   200   150   300</span></span></code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Accessing elements by name</span></span>
<span><span class="va">gene_expr</span><span class="op">[</span><span class="st">"gene2"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## gene2 </span></span>
<span><span class="co">##   200</span></span></code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Accessing multiple elements by name</span></span>
<span><span class="va">gene_expr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene1"</span>, <span class="st">"gene3"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## gene1 gene3 </span></span>
<span><span class="co">##   100   150</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="changing-and-removing-elements">7. Changing and Removing Elements<a class="anchor" aria-label="anchor" href="#changing-and-removing-elements"></a>
</h3>
<p>You can modify vectors by changing, removing, or adding elements:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Change the second element to 1000</span></span>
<span><span class="va">numbers</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">numbers</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]   10 1000   30   40  100</span></span></code></pre>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove the third element</span></span>
<span><span class="va">numbers</span> <span class="op">&lt;-</span> <span class="va">numbers</span><span class="op">[</span><span class="op">-</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">numbers</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]   10 1000   40  100</span></span></code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add new elements to the end of the vector</span></span>
<span><span class="va">numbers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">numbers</span>, <span class="fl">60</span>, <span class="fl">70</span><span class="op">)</span></span>
<span><span class="va">numbers</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]   10 1000   40  100   60   70</span></span></code></pre>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add a new named element</span></span>
<span><span class="va">gene_expr</span><span class="op">[</span><span class="st">"gene5"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">250</span></span>
<span><span class="va">gene_expr</span></span></code></pre></div>
<pre><code><span><span class="co">## gene1 gene2 gene3 gene4 gene5 </span></span>
<span><span class="co">##   100   200   150   300   250</span></span></code></pre>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Change an element by name</span></span>
<span><span class="va">gene_expr</span><span class="op">[</span><span class="st">"gene2"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">180</span></span>
<span><span class="va">gene_expr</span></span></code></pre></div>
<pre><code><span><span class="co">## gene1 gene2 gene3 gene4 gene5 </span></span>
<span><span class="co">##   100   180   150   300   250</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="installing-and-loading-packages">8. Installing and Loading Packages<a class="anchor" aria-label="anchor" href="#installing-and-loading-packages"></a>
</h3>
<p>While base R provides many functionalities, we often need additional
packages to perform specific tasks, especially in bioinformatics and
scRNA-seq analysis. Here’s how you can install and load packages:</p>
<div class="section level4">
<h4 id="installing-a-package-from-cran">Installing a package from CRAN<a class="anchor" aria-label="anchor" href="#installing-a-package-from-cran"></a>
</h4>
<p>To install a package from CRAN (The Comprehensive R Archive Network),
you can use the <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code> function. For example,
to install the popular data visualization package
<code>ggplot2</code>:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("ggplot2")</span></span></code></pre></div>
<p>Note: We’ve commented out this code as we won’t run it during the
class, but this is how you would typically install a package.</p>
</div>
<div class="section level4">
<h4 id="loading-a-package">Loading a package<a class="anchor" aria-label="anchor" href="#loading-a-package"></a>
</h4>
<p>Once a package is installed, you need to load it into your R session
to use its functions:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># library(ggplot2)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="installing-a-bioconductor-package">Installing a Bioconductor package<a class="anchor" aria-label="anchor" href="#installing-a-bioconductor-package"></a>
</h4>
<p>Bioconductor is a repository for bioinformatics packages. To install
a Bioconductor package, you first need to install the
<code>BiocManager</code> package:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if (!requireNamespace("BiocManager", quietly = TRUE))</span></span>
<span><span class="co">#   install.packages("BiocManager")</span></span>
<span><span class="co"># BiocManager::install("DESeq2")</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="loading-a-bioconductor-package">Loading a Bioconductor package<a class="anchor" aria-label="anchor" href="#loading-a-bioconductor-package"></a>
</h4>
<p>Once installed, you can load a Bioconductor package just like any
other package:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># library(DESeq2)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="getting-help">9. Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h3>
<p>R provides built-in help documentation for its functions. This is
crucial when you’re learning how to use a new function or need to remind
yourself of the details of a function you’ve used before.</p>
<p>There are two main ways to access help in R:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Getting help for a function</span></span>
<span><span class="op">?</span><span class="va">mean</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span></span></code></pre></div>
<p>Both of these commands will open the help page for the
<code>mean</code> function, which includes a description of what the
function does, its arguments, and often examples of how to use it.</p>
</div>
<div class="section level3">
<h3 id="data-frames">10. Data Frames<a class="anchor" aria-label="anchor" href="#data-frames"></a>
</h3>
<p>Data frames are table-like structures that are commonly used in R for
storing and manipulating data. They are particularly useful because they
can contain different types of data (numeric, character, logical) in
different columns.</p>
<p>Key properties of data frames: - Each column must contain the same
type of data (e.g., numeric, character) - Each row represents an
observation or case - Column names must be unique</p>
<p>Let’s create a simple data frame and explore its properties:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creating a data frame</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample1"</span>, <span class="st">"sample2"</span>, <span class="st">"sample3"</span>, <span class="st">"sample4"</span><span class="op">)</span>,</span>
<span>  expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">150</span>, <span class="fl">300</span><span class="op">)</span>,</span>
<span>  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"treatment"</span>, <span class="st">"control"</span>, <span class="st">"treatment"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    sample expression condition</span></span>
<span><span class="co">## 1 sample1        100   control</span></span>
<span><span class="co">## 2 sample2        200 treatment</span></span>
<span><span class="co">## 3 sample3        150   control</span></span>
<span><span class="co">## 4 sample4        300 treatment</span></span></code></pre>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dimensions of a data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4 3</span></span></code></pre>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4</span></span></code></pre>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3</span></span></code></pre>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Column names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "sample"     "expression" "condition"</span></span></code></pre>
<div class="section level4">
<h4 id="accessing-and-subsetting-data-frames">Accessing and Subsetting Data Frames<a class="anchor" aria-label="anchor" href="#accessing-and-subsetting-data-frames"></a>
</h4>
<p>There are several ways to access data in a data frame:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Accessing columns</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">sample</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "sample1" "sample2" "sample3" "sample4"</span></span></code></pre>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">[[</span><span class="st">"sample"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "sample1" "sample2" "sample3" "sample4"</span></span></code></pre>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span><span class="st">"sample"</span><span class="op">]</span>  <span class="co"># Returns a data frame</span></span></code></pre></div>
<pre><code><span><span class="co">##    sample</span></span>
<span><span class="co">## 1 sample1</span></span>
<span><span class="co">## 2 sample2</span></span>
<span><span class="co">## 3 sample3</span></span>
<span><span class="co">## 4 sample4</span></span></code></pre>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subsetting a data frame</span></span>
<span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="co"># Row 1 and 2, column 2 and 3</span></span></code></pre></div>
<pre><code><span><span class="co">##   expression condition</span></span>
<span><span class="co">## 1        100   control</span></span>
<span><span class="co">## 2        200 treatment</span></span></code></pre>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>  <span class="co"># First row, all columns</span></span></code></pre></div>
<pre><code><span><span class="co">##    sample expression condition</span></span>
<span><span class="co">## 1 sample1        100   control</span></span></code></pre>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"control"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample"</span>, <span class="st">"condition"</span><span class="op">)</span><span class="op">]</span> <span class="co"># Control sample rows, "sample" and "condition" columns</span></span></code></pre></div>
<pre><code><span><span class="co">##    sample condition</span></span>
<span><span class="co">## 1 sample1   control</span></span>
<span><span class="co">## 3 sample3   control</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="modifying-data-frames">Modifying Data Frames<a class="anchor" aria-label="anchor" href="#modifying-data-frames"></a>
</h4>
<p>We can add new columns or rows to a data frame, or modify existing
values:</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adding a new column</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">log_expression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code></pre></div>
<pre><code><span><span class="co">##    sample expression condition log_expression</span></span>
<span><span class="co">## 1 sample1        100   control       6.643856</span></span>
<span><span class="co">## 2 sample2        200 treatment       7.643856</span></span>
<span><span class="co">## 3 sample3        150   control       7.228819</span></span>
<span><span class="co">## 4 sample4        300 treatment       8.228819</span></span></code></pre>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adding a new row</span></span>
<span><span class="va">new_row</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="st">"sample5"</span>, expression <span class="op">=</span> <span class="fl">250</span>, condition <span class="op">=</span> <span class="st">"control"</span>, log_expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">new_row</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code></pre></div>
<pre><code><span><span class="co">##    sample expression condition log_expression</span></span>
<span><span class="co">## 1 sample1        100   control       6.643856</span></span>
<span><span class="co">## 2 sample2        200 treatment       7.643856</span></span>
<span><span class="co">## 3 sample3        150   control       7.228819</span></span>
<span><span class="co">## 4 sample4        300 treatment       8.228819</span></span>
<span><span class="co">## 5 sample5        250   control       7.965784</span></span></code></pre>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Changing specific values in a data frame</span></span>
<span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"control"</span>, <span class="st">"condition"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"C"</span></span>
<span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"treatment"</span>, <span class="st">"condition"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    sample expression condition log_expression</span></span>
<span><span class="co">## 1 sample1        100         C       6.643856</span></span>
<span><span class="co">## 2 sample2        200         T       7.643856</span></span>
<span><span class="co">## 3 sample3        150         C       7.228819</span></span>
<span><span class="co">## 4 sample4        300         T       8.228819</span></span>
<span><span class="co">## 5 sample5        250         C       7.965784</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="matrices">11. Matrices<a class="anchor" aria-label="anchor" href="#matrices"></a>
</h3>
<p>Matrices are similar to data frames in that they are two-dimensional,
but they have one key difference: all elements in a matrix must be of
the same data type (usually numeric).</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creating a matrix</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">## [1,]    1    4    7   10</span></span>
<span><span class="co">## [2,]    2    5    8   11</span></span>
<span><span class="co">## [3,]    3    6    9   12</span></span></code></pre>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adding row and column names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene1"</span>, <span class="st">"gene2"</span>, <span class="st">"gene3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cell1"</span>, <span class="st">"cell2"</span>, <span class="st">"cell3"</span>, <span class="st">"cell4"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       cell1 cell2 cell3 cell4</span></span>
<span><span class="co">## gene1     1     4     7    10</span></span>
<span><span class="co">## gene2     2     5     8    11</span></span>
<span><span class="co">## gene3     3     6     9    12</span></span></code></pre>
<div class="section level4">
<h4 id="matrix-operations">Matrix Operations<a class="anchor" aria-label="anchor" href="#matrix-operations"></a>
</h4>
<p>Matrices support various mathematical operations:</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Matrix operations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>  <span class="co"># Transpose</span></span></code></pre></div>
<pre><code><span><span class="co">##       gene1 gene2 gene3</span></span>
<span><span class="co">## cell1     1     2     3</span></span>
<span><span class="co">## cell2     4     5     6</span></span>
<span><span class="co">## cell3     7     8     9</span></span>
<span><span class="co">## cell4    10    11    12</span></span></code></pre>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">*</span> <span class="fl">2</span>  <span class="co"># Element-wise multiplication</span></span></code></pre></div>
<pre><code><span><span class="co">##       cell1 cell2 cell3 cell4</span></span>
<span><span class="co">## gene1     2     8    14    20</span></span>
<span><span class="co">## gene2     4    10    16    22</span></span>
<span><span class="co">## gene3     6    12    18    24</span></span></code></pre>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Applying functions to rows or columns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## cell1 cell2 cell3 cell4 </span></span>
<span><span class="co">##     6    15    24    33</span></span></code></pre>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## gene1 gene2 gene3 </span></span>
<span><span class="co">##   5.5   6.5   7.5</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="subsetting-matrices">Subsetting Matrices<a class="anchor" aria-label="anchor" href="#subsetting-matrices"></a>
</h4>
<p>Like data frames, matrices can be subsetted:</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subsetting a matrix</span></span>
<span><span class="va">m</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>  <span class="co"># First row</span></span></code></pre></div>
<pre><code><span><span class="co">## cell1 cell2 cell3 cell4 </span></span>
<span><span class="co">##     1     4     7    10</span></span></code></pre>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>  <span class="co"># Second column</span></span></code></pre></div>
<pre><code><span><span class="co">## gene1 gene2 gene3 </span></span>
<span><span class="co">##     4     5     6</span></span></code></pre>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>  <span class="co"># Submatrix</span></span></code></pre></div>
<pre><code><span><span class="co">##       cell3 cell4</span></span>
<span><span class="co">## gene1     7    10</span></span>
<span><span class="co">## gene2     8    11</span></span></code></pre>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene1"</span>,<span class="st">"gene3"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>  <span class="co"># Submatrix</span></span></code></pre></div>
<pre><code><span><span class="co">##       cell2 cell4</span></span>
<span><span class="co">## gene1     4    10</span></span>
<span><span class="co">## gene3     6    12</span></span></code></pre>
<p>In the context of single-cell RNA sequencing analysis, matrices are
often used to represent gene expression data, where rows typically
represent genes and columns represent cells. Understanding how to
manipulate these structures is crucial for effective data analysis in
bioinformatics.</p>
</div>
</div>
<div class="section level3">
<h3 id="factors">12. Factors<a class="anchor" aria-label="anchor" href="#factors"></a>
</h3>
<p>Factors are a special type of vector in R that are used to represent
categorical data. They are similar to vectors but are limited to a
predefined set of values, called levels.</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creating a factor</span></span>
<span><span class="va">symptoms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mild"</span>, <span class="st">"severe"</span>, <span class="st">"mild"</span>, <span class="st">"moderate"</span>, <span class="st">"moderate"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">symptoms</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] mild     severe   mild     moderate moderate</span></span>
<span><span class="co">## Levels: mild moderate severe</span></span></code></pre>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Levels of a factor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">symptoms</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "mild"     "moderate" "severe"</span></span></code></pre>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Changing levels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">symptoms</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"Mo"</span>, <span class="st">"S"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">symptoms</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] M  S  M  Mo Mo</span></span>
<span><span class="co">## Levels: M Mo S</span></span></code></pre>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using factors in data analysis</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">symptoms</span><span class="op">)</span></span>
<span><span class="va">counts</span></span></code></pre></div>
<pre><code><span><span class="co">## symptoms</span></span>
<span><span class="co">##  M Mo  S </span></span>
<span><span class="co">##  2  2  1</span></span></code></pre>
<p>One important application of factors in data visualization is
ordering. We can change the order of factor levels without changing the
factor’s content:</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example of how factor level order affects plotting</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">symptoms</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">counts</span>, main<span class="op">=</span><span class="st">"Symptom Severity"</span>, xlab<span class="op">=</span><span class="st">"Severity Level"</span><span class="op">)</span></span></code></pre></div>
<p><img src="1.basic-R_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Changing the order of levels</span></span>
<span><span class="va">symptoms_reordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">symptoms</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"Mo"</span>, <span class="st">"M"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">symptoms_reordered</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] M  S  M  Mo Mo</span></span>
<span><span class="co">## Levels: S Mo M</span></span></code></pre>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Changing the order for a different visualization</span></span>
<span><span class="va">counts_reordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">symptoms_reordered</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">counts_reordered</span>, main<span class="op">=</span><span class="st">"Symptom Severity (Reordered)"</span>, xlab<span class="op">=</span><span class="st">"Severity Level"</span><span class="op">)</span></span></code></pre></div>
<p><img src="1.basic-R_files/figure-html/unnamed-chunk-29-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="lists">13. Lists<a class="anchor" aria-label="anchor" href="#lists"></a>
</h3>
<p>Lists in R are versatile data structures that can contain elements of
different types, including other lists.</p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creating a list</span></span>
<span><span class="va">patient</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"PT001"</span>,</span>
<span>  age <span class="op">=</span> <span class="fl">45</span>,</span>
<span>  symptoms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fever"</span>, <span class="st">"cough"</span><span class="op">)</span>,</span>
<span>  test_results <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PCR"</span>, <span class="st">"Antibody"</span><span class="op">)</span>,</span>
<span>    result <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Negative"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">patient</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $id</span></span>
<span><span class="co">## [1] "PT001"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $age</span></span>
<span><span class="co">## [1] 45</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $symptoms</span></span>
<span><span class="co">## [1] "fever" "cough"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $test_results</span></span>
<span><span class="co">##       test   result</span></span>
<span><span class="co">## 1      PCR Positive</span></span>
<span><span class="co">## 2 Antibody Negative</span></span></code></pre>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Accessing list elements</span></span>
<span><span class="va">patient</span><span class="op">$</span><span class="va">id</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "PT001"</span></span></code></pre>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">patient</span><span class="op">[[</span><span class="st">"age"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 45</span></span></code></pre>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">patient</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "fever" "cough"</span></span></code></pre>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adding to a list</span></span>
<span><span class="va">patient</span><span class="op">$</span><span class="va">medication</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Aspirin"</span>, <span class="st">"Cough Syrup"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">patient</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $id</span></span>
<span><span class="co">## [1] "PT001"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $age</span></span>
<span><span class="co">## [1] 45</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $symptoms</span></span>
<span><span class="co">## [1] "fever" "cough"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $test_results</span></span>
<span><span class="co">##       test   result</span></span>
<span><span class="co">## 1      PCR Positive</span></span>
<span><span class="co">## 2 Antibody Negative</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $medication</span></span>
<span><span class="co">## [1] "Aspirin"     "Cough Syrup"</span></span></code></pre>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Nested list operations</span></span>
<span><span class="va">patient</span><span class="op">$</span><span class="va">test_results</span><span class="op">$</span><span class="va">result</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Positive" "Negative"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="if-else-statements">14. If-Else Statements<a class="anchor" aria-label="anchor" href="#if-else-statements"></a>
</h3>
<p>If-else statements allow you to execute different code blocks based
on certain conditions.</p>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example 1: Checking gene expression levels</span></span>
<span><span class="va">gene_expression</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">gene_expression</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"High expression"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Low expression"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "High expression"</span></span></code></pre>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example 2: Classifying cells based on marker gene expression</span></span>
<span><span class="va">cd4_expression</span> <span class="op">&lt;-</span> <span class="fl">80</span></span>
<span><span class="va">cd8_expression</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">cd4_expression</span> <span class="op">&gt;</span> <span class="fl">50</span> <span class="op">&amp;</span> <span class="va">cd8_expression</span> <span class="op">&lt;</span> <span class="fl">30</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"This cell is likely a CD4+ T cell"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">cd8_expression</span> <span class="op">&gt;</span> <span class="fl">50</span> <span class="op">&amp;</span> <span class="va">cd4_expression</span> <span class="op">&lt;</span> <span class="fl">30</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"This cell is likely a CD8+ T cell"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Cell type is uncertain"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "This cell is likely a CD4+ T cell"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="basic-for-loops-in-r-for-scrna-seq-analysis">15. Basic For Loops in R for scRNA-seq Analysis<a class="anchor" aria-label="anchor" href="#basic-for-loops-in-r-for-scrna-seq-analysis"></a>
</h3>
<p>For loops are used when we need to repeat a series of operations
multiple times. For example, we might need to read sequencing data for
20 samples. Instead of copying and pasting the same code 20 times and
manually changing each value, we can use a loop.</p>
<p>The basic format of a for loop is:</p>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">variable</span> <span class="kw">in</span> <span class="va">sequence</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># code to be repeated</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Here are some examples:</p>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example 1: Printing numbers from 1 to 5</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="co">## [1] 3</span></span>
<span><span class="co">## [1] 4</span></span>
<span><span class="co">## [1] 5</span></span></code></pre>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example 2: Calculating mean expression for multiple genes</span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GENE1"</span>, <span class="st">"GENE2"</span>, <span class="st">"GENE3"</span>, <span class="st">"GENE4"</span><span class="op">)</span></span>
<span><span class="va">expression_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  GENE1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">15</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>  GENE2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">60</span>, <span class="fl">55</span>, <span class="fl">65</span><span class="op">)</span>,</span>
<span>  GENE3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>  GENE4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">120</span>, <span class="fl">110</span>, <span class="fl">130</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">expression_values</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $GENE1</span></span>
<span><span class="co">## [1] 10 20 15 25</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $GENE2</span></span>
<span><span class="co">## [1] 50 60 55 65</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $GENE3</span></span>
<span><span class="co">## [1] 5 8 6 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $GENE4</span></span>
<span><span class="co">## [1] 100 120 110 130</span></span></code></pre>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">gene</span> <span class="kw">in</span> <span class="va">genes</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">mean_expression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">expression_values</span><span class="op">[[</span><span class="va">gene</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean expression of"</span>, <span class="va">gene</span>, <span class="st">":"</span>, <span class="va">mean_expression</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## Mean expression of GENE1 : 17.5 </span></span>
<span><span class="co">## Mean expression of GENE2 : 57.5 </span></span>
<span><span class="co">## Mean expression of GENE3 : 6.5 </span></span>
<span><span class="co">## Mean expression of GENE4 : 115</span></span></code></pre>
<p>In this last example, we’re iterating over a list of genes,
calculating the mean expression for each gene, and printing the results.
This demonstrates how loops can be used to perform repetitive tasks
efficiently in the context of gene expression analysis.</p>
</div>
<div class="section level3">
<h3 id="working-with-file-paths">16. Working with File Paths<a class="anchor" aria-label="anchor" href="#working-with-file-paths"></a>
</h3>
<p>In many cases, we need to interact with files on our hard drive. This
could be for reading large external datasets (like CSV files downloaded
from the GEO database) or exporting our analysis results to files (CSV
or Excel). Understanding how to work with file paths is crucial for
these operations.</p>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get current working directory</span></span>
<span><span class="va">current_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">current_dir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/home/hyc/Documents/GitHub/SeuratExtend/vignettes/single-cell-course"</span></span></code></pre>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set working directory</span></span>
<span><span class="co"># setwd("/path/to/your/directory")  # Uncomment and modify as needed</span></span>
<span></span>
<span><span class="co"># Construct file paths</span></span>
<span><span class="va">results_dir</span> <span class="op">&lt;-</span> <span class="st">"results"</span></span>
<span><span class="va">csv_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">results_dir</span>, <span class="st">"gene_expression.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">csv_file</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "results/gene_expression.csv"</span></span></code></pre>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the 'results' directory if it doesn't exist</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">results_dir</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">results_dir</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Created directory:"</span>, <span class="va">results_dir</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="writing-and-reading-csv-files">17. Writing and Reading CSV Files<a class="anchor" aria-label="anchor" href="#writing-and-reading-csv-files"></a>
</h3>
<p>CSV (Comma-Separated Values) files are a common format for storing
tabular data. R provides functions to easily read from and write to CSV
files.</p>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a sample data frame to write</span></span>
<span><span class="va">gene_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  gene_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GENE1"</span>, <span class="st">"GENE2"</span>, <span class="st">"GENE3"</span>, <span class="st">"GENE4"</span><span class="op">)</span>,</span>
<span>  expression_level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10.5</span>, <span class="fl">20.3</span>, <span class="fl">15.7</span>, <span class="fl">30.2</span><span class="op">)</span>,</span>
<span>  p_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gene_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   gene_id expression_level p_value</span></span>
<span><span class="co">## 1   GENE1             10.5   0.001</span></span>
<span><span class="co">## 2   GENE2             20.3   0.050</span></span>
<span><span class="co">## 3   GENE3             15.7   0.010</span></span>
<span><span class="co">## 4   GENE4             30.2   0.001</span></span></code></pre>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Write the data frame to a CSV file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">gene_data</span>, file <span class="op">=</span> <span class="va">csv_file</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Data written to CSV file:"</span>, <span class="va">csv_file</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Data written to CSV file: results/gene_expression.csv"</span></span></code></pre>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read the CSV file we just created</span></span>
<span><span class="va">read_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">csv_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">read_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   gene_id expression_level p_value</span></span>
<span><span class="co">## 1   GENE1             10.5   0.001</span></span>
<span><span class="co">## 2   GENE2             20.3   0.050</span></span>
<span><span class="co">## 3   GENE3             15.7   0.010</span></span>
<span><span class="co">## 4   GENE4             30.2   0.001</span></span></code></pre>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read a specific number of rows</span></span>
<span><span class="va">gene_data_head</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">csv_file</span>, nrows <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"First 2 rows of data:"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "First 2 rows of data:"</span></span></code></pre>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gene_data_head</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   gene_id expression_level p_value</span></span>
<span><span class="co">## 1   GENE1             10.5   0.001</span></span>
<span><span class="co">## 2   GENE2             20.3   0.050</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="writing-and-reading-rds-files">18. Writing and Reading RDS Files<a class="anchor" aria-label="anchor" href="#writing-and-reading-rds-files"></a>
</h3>
<p>While CSV is a text-based format that can store tabular data, many R
objects cannot be easily converted to text. For these cases, R provides
the RDS (R Data Serialization) format, which can store any R object.</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Write the data frame to an RDS file</span></span>
<span><span class="va">rds_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">results_dir</span>, <span class="st">"gene_expression.rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">gene_data</span>, file <span class="op">=</span> <span class="va">rds_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Data written to RDS file:"</span>, <span class="va">rds_file</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Data written to RDS file: results/gene_expression.rds"</span></span></code></pre>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read the RDS file we just created</span></span>
<span><span class="va">read_rds_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">rds_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">read_rds_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   gene_id expression_level p_value</span></span>
<span><span class="co">## 1   GENE1             10.5   0.001</span></span>
<span><span class="co">## 2   GENE2             20.3   0.050</span></span>
<span><span class="co">## 3   GENE3             15.7   0.010</span></span>
<span><span class="co">## 4   GENE4             30.2   0.001</span></span></code></pre>
<p>RDS files are particularly useful when working with complex R
objects, such as large data frames, lists, or custom objects that you
want to save and reload later without losing any information or
structure.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion-and-next-steps">Conclusion and Next Steps<a class="anchor" aria-label="anchor" href="#conclusion-and-next-steps"></a>
</h2>
<p>Congratulations! You have completed the preparatory work for learning
R programming. Our next step will be to dive into single-cell analysis.
To begin this journey, we need to install the Seurat package, which is a
powerful toolkit for single-cell genomics.</p>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"Seurat"</span><span class="op">)</span></span></code></pre></div>
<p>Note: If you’ve never used related R packages before, you might be
prompted to install Rtools (on Windows). You can download the
appropriate version from the official website following these
instructions: <a href="https://cran.rstudio.com/bin/windows/Rtools/" class="external-link uri">https://cran.rstudio.com/bin/windows/Rtools/</a></p>
<div class="section level3">
<h3 id="tips-for-learning-r">Tips for Learning R<a class="anchor" aria-label="anchor" href="#tips-for-learning-r"></a>
</h3>
<p>A crucial skill in R programming is the ability to search
documentation and find help resources. Once you understand these basic
principles, you don’t need to memorize the spelling of every function
name or the usage of every parameter - that would be nearly impossible
given the vast number of functions and parameters you’ll encounter.</p>
<p>The key is knowing how to find these functions and their
corresponding usage. In this course, we introduced the use of
<code>?</code> to display help documentation. Official package websites
often have tutorials for reference.</p>
<p>Moreover, the rise of large language models has significantly changed
the game. They can help you quickly and easily master a language with
remarkable efficiency. You can ask any question to a chatbot, and it
will provide you with detailed explanations. We recommend Claude and
ChatGPT:</p>
<ul>
<li><a href="https://claude.ai/" class="external-link">Claude</a></li>
<li><a href="https://chatgpt.com/" class="external-link">ChatGPT</a></li>
</ul>
<p>Remember, the journey of learning R and bioinformatics is ongoing. As
you progress, you’ll find that your ability to solve problems and find
information improves. Don’t be discouraged if you encounter difficulties
- they’re a natural part of the learning process.</p>
<p>In our next lesson, we’ll start exploring the Seurat package and
begin our journey into single-cell RNA sequencing analysis. Get ready
for an exciting adventure in the world of bioinformatics!</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Yichao Hua.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
